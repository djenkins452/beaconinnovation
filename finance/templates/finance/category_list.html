{% extends "finance/base.html" %}

{% block title %}Categories{% endblock %}

{% block content %}
<div class="card">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h1>Categories</h1>
        <div>
            <a href="{% url 'finance:category_create' %}?type=expense" class="btn btn-primary">+ Expense Category</a>
            <a href="{% url 'finance:category_create' %}?type=income" class="btn btn-primary">+ Income Category</a>
        </div>
    </div>

    <div style="display: flex; gap: 30px;">
        <!-- Expense Categories -->
        <div style="flex: 1;">
            <h2 style="margin-bottom: 15px; color: #e74c3c;">
                <span style="margin-right: 8px;">ðŸ’³</span>
                Expense Categories ({{ expense_categories|length }})
            </h2>

            {% if expense_categories %}
            <table>
                <thead>
                    <tr>
                        <th style="width: 40px;">Order</th>
                        <th>Name</th>
                        <th style="text-align: center;">Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for category in expense_categories %}
                    <tr {% if not category.is_active %}style="opacity: 0.6;"{% endif %}>
                        <td class="text-muted">{{ category.display_order }}</td>
                        <td>
                            <a href="{% url 'finance:category_detail' category.id %}" style="font-weight: 500;">
                                {{ category.name }}
                            </a>
                            {% if category.is_system %}
                            <span class="badge" style="background-color: #3498db; color: white; font-size: 10px;">System</span>
                            {% endif %}
                        </td>
                        <td style="text-align: center;">
                            {% if category.is_active %}
                            <span class="badge badge-income">Active</span>
                            {% else %}
                            <span class="badge" style="background-color: #95a5a6; color: white;">Inactive</span>
                            {% endif %}
                        </td>
                        <td>
                            <a href="{% url 'finance:category_edit' category.id %}" class="btn btn-secondary" style="padding: 3px 8px; font-size: 11px;">Edit</a>
                            <form action="{% url 'finance:category_toggle_active' category.id %}" method="post" style="display: inline;">
                                {% csrf_token %}
                                <button type="submit" class="btn btn-secondary" style="padding: 3px 8px; font-size: 11px;">
                                    {% if category.is_active %}Deactivate{% else %}Activate{% endif %}
                                </button>
                            </form>
                            {% if not category.is_system %}
                            <form action="{% url 'finance:category_delete' category.id %}" method="post" style="display: inline;" onsubmit="return confirm('Are you sure you want to delete this category?');">
                                {% csrf_token %}
                                <button type="submit" class="btn btn-secondary" style="padding: 3px 8px; font-size: 11px; color: #e74c3c;">Delete</button>
                            </form>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <p class="text-muted">No expense categories yet.</p>
            {% endif %}
        </div>

        <!-- Income Categories -->
        <div style="flex: 1;">
            <h2 style="margin-bottom: 15px; color: #27ae60;">
                <span style="margin-right: 8px;">ðŸ’°</span>
                Income Categories ({{ income_categories|length }})
            </h2>

            {% if income_categories %}
            <table>
                <thead>
                    <tr>
                        <th style="width: 40px;">Order</th>
                        <th>Name</th>
                        <th style="text-align: center;">Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for category in income_categories %}
                    <tr {% if not category.is_active %}style="opacity: 0.6;"{% endif %}>
                        <td class="text-muted">{{ category.display_order }}</td>
                        <td>
                            <a href="{% url 'finance:category_detail' category.id %}" style="font-weight: 500;">
                                {{ category.name }}
                            </a>
                            {% if category.is_system %}
                            <span class="badge" style="background-color: #3498db; color: white; font-size: 10px;">System</span>
                            {% endif %}
                        </td>
                        <td style="text-align: center;">
                            {% if category.is_active %}
                            <span class="badge badge-income">Active</span>
                            {% else %}
                            <span class="badge" style="background-color: #95a5a6; color: white;">Inactive</span>
                            {% endif %}
                        </td>
                        <td>
                            <a href="{% url 'finance:category_edit' category.id %}" class="btn btn-secondary" style="padding: 3px 8px; font-size: 11px;">Edit</a>
                            <form action="{% url 'finance:category_toggle_active' category.id %}" method="post" style="display: inline;">
                                {% csrf_token %}
                                <button type="submit" class="btn btn-secondary" style="padding: 3px 8px; font-size: 11px;">
                                    {% if category.is_active %}Deactivate{% else %}Activate{% endif %}
                                </button>
                            </form>
                            {% if not category.is_system %}
                            <form action="{% url 'finance:category_delete' category.id %}" method="post" style="display: inline;" onsubmit="return confirm('Are you sure you want to delete this category?');">
                                {% csrf_token %}
                                <button type="submit" class="btn btn-secondary" style="padding: 3px 8px; font-size: 11px; color: #e74c3c;">Delete</button>
                            </form>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <p class="text-muted">No income categories yet.</p>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
